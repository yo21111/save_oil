<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="description" content="" />
	<meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors" />
	<meta name="generator" content="Hugo 0.84.0" />
	<title>Save Oil</title>

	<!-- Bootstrap core CSS -->

	<!-- include summernote css/js -->

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
	<link href="/css/bootstrap.min.css" rel="stylesheet" />
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

	<link rel="stylesheet" href="/css/summernote/summernote-lite.css">

	<style>
		main {
			padding-bottom: 100px;
		}

		.bd-placeholder-img {
			font-size: 1.125rem;
			text-anchor: middle;
			-webkit-user-select: none;
			-moz-user-select: none;
			user-select: none;
		}

		input#searchInput {
			width: 20rem;
		}

		button#searchBtn {
			width: 5rem;
		}

		#searchForm button,
		#searchForm input {
			margin-right: 10px;
		}

		div#navArea ul {
			padding-left: 10px;
		}

		div#navArea ul li a {
			font-size: 0.9rem;
			font-weight: bold;
		}

		div#summernote {
			height: 500px;
			border: 1px solid #ddd;
			border-radius: 3px;
			user-select: none;
		}

		div#commentArea {
			flex: 1;
		}

		input#commentInput {
			width: 100%;
			border: 1px solid #aaa;
			border-radius: 3px;
			padding: 5px;
		}

		@media (max-width: 768px) {
			div#searchArea {
				display: none;
			}

			div#navArea ul li a {
				font-size: 0.8rem;
				transform: translateY(4px);
			}
		}

		@media (min-width: 768px) {
			.bd-placeholder-img-lg {
				font-size: 3.5rem;
			}
		}
	</style>

	<!-- Custom styles for this template -->
</head>

<body class="bg-light">
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark" aria-label="Main navigation">
		<div class="container-fluid">
			<a class="navbar-brand" href="#">Save Oil</a>
			<div class="navbar-collapse offcanvas-collapse" id="navbarsExampleDefault">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item">
						<a class="nav-link active" aria-current="page" href="/board/list">커뮤니티</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="/">주유소 검색</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<main class="container">
		<div class="d-flex justify-content-between align-items-center p-3 my-3 text-white bg-purple rounded shadow-sm">
			<div>
				<img id="Logo" class="me-2" src="https://ifh.cc/g/AOtB7m.png" border="0" width="58" height="48" />
			</div>
			<div>
				<form id="searchForm" class="d-flex">
					<input id="searchInput" class="form-control me-2" type="search" placeholder="검색하실 내용을 입력해주세요."
						aria-label="Search" name="search" />
					<button id="searchBtn" class="btn btn-dark" type="button">검색</button>
				</form>
			</div>
		</div>

		<div class="my-3 p-3 bg-body rounded shadow-sm">
			<!-- 게시글 읽을 때 -->
			<h3 th:text="${board.title}" class="mb-3 w-100 p-2 font-weight-bold">제목 부분</h3>
			<div class="d-flex justify-content-between mb-3 p-2 text-muted">
				<div th:text="${board.member.id}">작성자</div>
				<div>
					조회수 : <span th:text="${board.viewCnt}">조회수</span>
					<span th:if="${board.reWriteDate eq null}" th:text="${#dates.format(board.writeDate, 'yyyy-MM-dd hh:mm')}" class="pl-5">작성일자</span>
					<span th:if="${board.reWriteDate ne null}" th:text="${#dates.format(board.reWriteDate, 'yyyy-MM-dd hh:mm')}" class="pl-5">작성일자</span>
				</div>
			</div>
			<div id="summernote" th:text="${board.content}" class="mb-3 w-100 p-2">작성한 내용</div>
			<div class="text-right mt-3" id="buttonArea">
				<a th:if="${session.uId_Session eq board.member.id}" th:href="|@{/board/delete/}${board.wNo}|" class="btn btn-outline-dark">삭제</a>
				<a th:if="${session.uId_Session eq board.member.id}" th:href="|@{/board/rewrite/}${board.wNo}|" class="btn btn-outline-dark">수정</a>
				<a href="/board/list" class="btn btn-outline-dark">목록</a>
			</div>
		</div>
		<div class="mt-5">
			<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
				class="bi bi-chat-dots" viewBox="0 0 20 20">
				<path
					d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
				<path
					d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z" />
			</svg>
			<span th:text="${#lists.size(board.comments)}"></span> 개
		</div>
		<div class="mt-3 mb-3 pb-3 border-bottom">
			<form action="/comment/write" id="commentForm" method="post">
				<div>
					<input type="hidden" name="wNo" th:value="${board.wNo}">
				</div>
				<div class="d-flex justify-content-between align-items-center">
					<div id="commentArea">
						<input id="commentInput" maxlength="60" placeholder="댓글을 입력해주세요.  (60자까지 입력 가능합니다.)"
							name="comment" type="text" />
					</div>
					<button class="btn btn-outline-primary ml-2" type="button">등록</button>
				</div>
			</form>
		</div>
		<div>
			<div class="d-flex row align-items-center text-center border-bottom">
				<div class="p-1 col-7">내용</div>
				<div class="p-1 col-2">작성자</div>
				<div class="p-1 col-2">작성일자</div>
				<div class="p-1 col-1"></div>
			</div>
		</div>
		<div id="commentList" th:each="comment : ${board.comments}" class="mb-6 d-flex align-items-center text-center border-bottom">
			<div th:if="${commentStat.size} == 0" class="p-3 text-center">아직 작성된 댓글이 없습니다.</div>
			<div th:text="${comment.comment}" class="p-1 col-7"></div>
			<div th:text="${comment.member.id}" class="p-1 col-2">작성자</div>
			<div th:if="${comment.reWriteDate eq null}" th:text="${#dates.format(comment.writeDate, 'yyyy-MM-dd hh:mm')}" class="p-1 col-2">작성일자</div>
			<div th:if="${comment.reWriteDate ne null}" th:text="${#dates.format(comment.reWriteDate, 'yyyy-MM-dd hh:mm')}" class="p-1 col-2">작성일자</div>
          	<div class="p-1 col-1">
            	<button th:if="${session.uId_Session} ne ${comment.member.id}" id="tagBtn" type="button" class="btn text-right">
	              <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-chat-dots-fill" viewBox="0 0 18 19">
	                <path d="M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM5 8a1 1 0 1 0-2 0 1 1 0 0 0 2 0zm4 0a1 1 0 1 0-2 0 1 1 0 0 0 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
	              </svg>
           		</button>
   		        <button th:if="${session.uId_Session} eq ${comment.member.id}" id="deleteBtn" type="button" class="btn text-right">
   		        	<input type="hidden" id="commentNo" name="cNo" th:value="${comment.cNo}">
            		<svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" fill="currentColor" class="bi bi-x-square-fill" viewBox="0 0 16 16">
             		 <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708z" />
            		</svg>
          		</button>
          	</div>
		</div>
	</main>
	<script>
		$(function () {
			$("button#searchBtn").click(function () {
				let search = $("input#searchInput").val().trim();

				$("form#searchForm").attr("action", "/board/list?search=" + search);
				$("form#searchForm").submit();
			});

			$("button#deleteBtn").click(function () {
				let cNo = $("#commentNo").val();
				location.href = "/comment/delete?cNo="+cNo;
			});

			$("button#tagBtn").click(function () {
				let writer = $(this).parent().prev().prev().text();
				$("#commentInput").val("@" + writer + "; ");
				$("#commentInput").focus();
			});
			
			$("form#commentForm button").click(function() {
				$("form#commentForm").submit();
			});
		});
	</script>
</body>

</html>